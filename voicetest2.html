<html>
<body>

<span id = "speech"> </span>
<input type = "submit" value = "begin" onclick = "beginRecording(event)"></input>

<script>
var speech = document.getElementById('speech');

var final_transcript = '';

var recognition = new webkitSpeechRecognition(), //master variable with built-ins

recognizing = false; //boolean state for if we're listening

window.onload = function() {
	recognition.start; //automatically start this shit
}


recognition.onstart = function() {
	console.log('maybe its listening');
	recognizing = true;
}

recognition.onend = function() {
	recognizing = false;
}

recognition.onresult = function(evt) {
	var interim_transcript = '';
    if (typeof(evt.results) == 'undefined') {
      recognition.onend = null;
      recognition.stop();
      return;
    }
    for (var i = evt.resultIndex; i < evt.results.length; ++i) {
      if (evt.results[i].isFinal) {
        final_transcript += evt.results[i][0].transcript;
      } else {
        interim_transcript += evt.results[i][0].transcript;
      }
    }
    speech.innerHTML = linebreak(final_transcript);
    interim_span.innerHTML = linebreak(interim_transcript);
  };


var two_line = /\n\n/g;
var one_line = /\n/g;
function linebreak(s) {
  return s.replace(two_line, '<p></p>').replace(one_line, '<br>');
}

function beginRecording(evt){
	console.log('what');
	if(recognizing){
		console.log('stopped');
		recognition.stop();
		return;
	}
	  final_transcript = '';
	  recognition.start();
	  speech.innerHTML = '';
	
}

</script>