<html>
<body>

<span id = "speech"> </span>
<input type = "submit" value = "begin" onclick = "beginRecording(event)"></input>

<script>
var speech = document.getElementById('speech');

var final_transcript = '';

var recognition = new webkitSpeechRecognition(), //master variable with built-ins

recognizing = false; //boolean state for if we're listening



recognition.onstart = function() {
	console.log('maybe its listening');
	recognizing = true;
}

recognition.onend = function() {
	recognizing = false;
}

recognition.onresult = function(evt) {
    if (typeof(evt.results) == 'undefined') {
      recognition.onend = null;
      recognition.stop();
      return;
    }
    for (var i = evt.resultIndex; i < evt.results.length; ++i) {
      if (evt.results[i].isFinal) {
        final_transcript += evt.results[i][0].transcript;
      } 
    }
    final_transcript = final_transcript.replace(/\s/g, '');
    speech.innerHTML(final_transcript);
  };


function beginRecording(evt){
	console.log('what');
	if(recognizing){
		console.log('stopped');
		recognition.stop();
		return;
	}
	  final_transcript = '';
	  recognition.start();
	  speech.innerHTML = '';
	
}

</script>